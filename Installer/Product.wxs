<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
	<?define ProductName="WordsLive"?>
	<?define Manufacturer="WordsLive"?>
	<?define UpgradeCode="178f61e3-6be1-4081-9383-af3d34b29d08"?>

	<Product Id="*" Name="$(var.ProductName)" Language="!(loc.LANG)" Version="!(bind.FileVersion.MainApplicationExe)" Manufacturer="$(var.Manufacturer)" UpgradeCode="$(var.UpgradeCode)">
		<Package InstallerVersion="405" Compressed="yes" InstallScope="perMachine" />

		<PropertyRef Id="NETFRAMEWORK40CLIENT"/>

		<Condition Message="!(loc.NetFxErrorMessage)">
			<![CDATA[Installed OR NETFRAMEWORK40CLIENT]]>
		</Condition>

		<MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeErrorMessage)" />
		<Media Id="1" Cabinet="media1.cab" EmbedCab="yes"/>

		<!-- ARP Support Oder wie konfiguriert man Add/Remove Programs mit dem Windows Installer
				Siehe auch http://msdn.microsoft.com/en-us/library/aa368032.aspx
		-->
		<Property Id="ARPHELPLINK" Value="http://wordslive.org" />
		<Property Id="ARPCONTACT" Value="WordsLive" />
		<Property Id="ARPCOMMENTS" Value="Worship Projection Software" />
		<Property Id="ARPURLINFOABOUT" Value="http://wordslive.org" />
		<Property Id="ARPPRODUCTICON" Value="Icon.ico" />

		<Feature Id="ProductFeature" ConfigurableDirectory="APPLICATIONFOLDER" Level="1">
			<ComponentGroupRef Id="MainAssemblies" />
			<ComponentGroupRef Id="ThirdPartyAssemblies" />
			<ComponentGroupRef Id="ServerAssemblies" />
			<ComponentGroupRef Id="VlcDotNetAssemblies" />
			<ComponentGroupRef Id="PowerpointViewerLibComponents" />
			<ComponentGroupRef Id="AwesomiumComponents" />
			<ComponentGroupRef Id="DataComponents" />
			<ComponentGroupRef Id="I18nComponents"/>
			<ComponentGroupRef Id="MicrosoftAssemblies"/>
			<ComponentRef Id="StartMenuShortcutsFolder"/>
		</Feature>

		<Feature Id="VCRedistFeature" Title="Visual C++ 2010 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
			<MergeRef Id="VCRedist"/>
		</Feature>

		<Property Id="WIXUI_INSTALLDIR" Value="APPLICATIONFOLDER" />

		<UI>
			<UIRef Id="WixUI_InstallDirNoLicense" />
			<UIRef Id="WixUI_ErrorProgressText" />
		</UI>
		<WixVariable Id="WixUIBannerBmp" Value="$(var.WordsLive.ProjectDir)Artwork\InstallerBanner.bmp" />
		<WixVariable Id="WixUIDialogBmp" Value="$(var.WordsLive.ProjectDir)Artwork\InstallerDialog.bmp" />

		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="APPLICATIONFOLDER" Name="$(var.ProductName)">
					<Directory Id="DataFolder" Name="Data"/>
					<Directory Id="I18nDeFolder" Name="de"/>
				</Directory>
			</Directory>

			<Directory Id="ProgramMenuFolder">
				<Directory Id="StartMenuShortcutsFolder" Name="$(var.ProductName)">
					<Component Id="StartMenuShortcutsFolder" Guid="A2FEC1B6-FE5E-11E1-B4D2-FD4D6188709B">
						<RemoveFolder Id='StartMenuShortcutsFolder' On='uninstall' />
						<RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
					</Component>
				</Directory>
			</Directory>
			<!-- Wird benötigt um den Desktop Shortcut anlegen zu können -->
			<Directory Id="DesktopFolder" Name="Desktop" />
		</Directory>

		<Icon Id="Icon.ico" SourceFile="$(var.WordsLive.ProjectDir)Artwork\Icon.ico" />

		<DirectoryRef Id="APPLICATIONFOLDER">
			<Merge Id="VCRedist" SourceFile="$(var.ProjectDir)Microsoft_VC110_CRT_x86.msm" DiskId="1" Language="0"/>
		</DirectoryRef>
	</Product>

	<Fragment>
		<ComponentGroup Id="MainAssemblies" Directory="APPLICATIONFOLDER">
			<Component Id="MainComponent">
				<File Id="MainApplicationExe" Source="$(var.WordsLive.TargetDir)WordsLive.exe" Name="WordsLive.exe" KeyPath="yes" />
				<File Source="$(var.WordsLive.TargetDir)WordsLive.exe.config" Name="WordsLive.exe.config"/>
				<Shortcut Id="StartmenuApplicationShortcut" Directory="StartMenuShortcutsFolder" Name="$(var.ProductName)"
									WorkingDirectory='APPLICATIONFOLDER' Icon="Icon.ico" IconIndex="0" Advertise="yes" />
				<Shortcut Id="DesktopApplicationShortcut" Directory="DesktopFolder" Name="$(var.ProductName)"
					WorkingDirectory='APPLICATIONFOLDER' Icon="Icon.ico" IconIndex="0" Advertise="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Core.dll" Name="WordsLive.Core.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Core.dll.config" Name="WordsLive.Core.dll.config" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Server.dll" Name="WordsLive.Server.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Server.dll.config" Name="WordsLive.Server.dll.config" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Presentation.dll" Name="WordsLive.Presentation.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Presentation.Wpf.dll" Name="WordsLive.Presentation.Wpf.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Presentation.Wpf.dll.config" Name="WordsLive.Presentation.Wpf.dll.config" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Slideshow.Powerpoint.Bridge.dll" Name="WordsLive.Slideshow.Powerpoint.Bridge.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Slideshow.Powerpoint.Bridge.dll.config" Name="WordsLive.Slideshow.Powerpoint.Bridge.dll.config" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Slideshow.Impress.Bridge.dll" Name="WordsLive.Slideshow.Impress.Bridge.dll" KeyPath="yes" />
			</Component>
		  <Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Slideshow.Impress.Bridge.dll.config" Name="WordsLive.Slideshow.Impress.Bridge.dll.config" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="ThirdPartyAssemblies" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Ionic.Zip.dll" Name="Ionic.Zip.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)MonitoredUndo.dll" Name="MonitoredUndo.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Xceed.Wpf.Toolkit.dll" Name="Xceed.Wpf.Toolkit.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Newtonsoft.Json.dll" Name="Newtonsoft.Json.dll" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="ServerAssemblies" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Firefly.dll" Name="Firefly.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Owin.dll" Name="Owin.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Owin.Types.dll" Name="Owin.Types.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Owin.Builder.dll" Name="Owin.Builder.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Owin.Extensions.dll" Name="Owin.Extensions.dll" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="VlcDotNetAssemblies" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Vlc.DotNet.Core.dll" Name="Vlc.DotNet.Core.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Vlc.DotNet.Core.Interops.dll" Name="Vlc.DotNet.Core.Interops.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Vlc.DotNet.Wpf.dll" Name="Vlc.DotNet.Wpf.dll" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="PowerpointViewerLibComponents" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)pptviewlib.dll" Name="pptviewlib.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)PowerpointViewerLib.dll" Name="PowerpointViewerLib.dll" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="AwesomiumComponents" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)awesomium.dll" Name="awesomium.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)WordsLive.Awesomium.exe" Name="WordsLive.Awesomium.exe" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Awesomium.Core.dll" Name="Awesomium.Core.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Awesomium.Windows.Controls.dll" Name="Awesomium.Windows.Controls.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)icudt.dll" Name="icudt.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)avcodec-53.dll" Name="avcodec-53.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)avformat-53.dll" Name="avformat-53.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)avutil-51.dll" Name="avutil-51.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)libEGL.dll" Name="libEGL.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)libGLESv2.dll" Name="libGLESv2.dll" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)xinput9_1_0.dll" Name="xinput9_1_0.dll" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="DataComponents" Directory="DataFolder">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Data\Standard.ppl" Name="Standard.ppl" KeyPath="yes" />
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)Data\Examples.zip" Name="Examples.zip" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="I18nComponents">
			<Component Directory="I18nDeFolder">
				<File Source="$(var.WordsLive.TargetDir)de\WordsLive.resources.dll" Name="WordsLive.resources.dll" KeyPath="yes"/>
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="MicrosoftAssemblies" Directory="APPLICATIONFOLDER">
			<Component>
				<File Source="$(var.WordsLive.TargetDir)System.Security.Cryptography.Algorithms.dll" Name="System.Security.Cryptography.Algorithms.dll" KeyPath="yes"/>
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)System.Security.Cryptography.X509Certificates.dll" Name="System.Security.Cryptography.X509Certificates.dll" KeyPath="yes"/>
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)System.Security.Cryptography.Primitives.dll" Name="System.Security.Cryptography.Primitives.dll" KeyPath="yes"/>
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)System.Security.Cryptography.Encoding.dll" Name="System.Security.Cryptography.Encoding.dll" KeyPath="yes"/>
			</Component>
			<Component>
				<File Source="$(var.WordsLive.TargetDir)System.Net.Http.dll" Name="System.Net.Http.dll" KeyPath="yes"/>
			</Component>
		</ComponentGroup>
	</Fragment>
</Wix>